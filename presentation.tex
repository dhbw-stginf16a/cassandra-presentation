\documentclass[10pt]{beamer}

\usepackage{pgfpages}

%\setbeameroption{show notes on second screen}

\usetheme{metropolis}
\usepackage{appendixnumberbeamer}

\usepackage{booktabs}
\usepackage[scale=2]{ccicons}

\usepackage{pgfplots}
\usepgfplotslibrary{dateplot}

\usepackage{xspace}
\newcommand{\themename}{\textbf{\textsc{metropolis}}\xspace}

\usepackage{graphicx}
\usepackage{listings}

\usepackage{lmodern}

\usepackage{eurosym}
\usepackage{amsmath, amssymb}
\usepackage[binary-units=true]{siunitx}
\DeclareSIUnit{\EUR}{\text{\euro}}

\usepackage{xcolor}
\newcommand\crule[3][black]{\textcolor{#1}{\rule{#2}{#3}}}
\definecolor{aswe-reactive}{cmyk}{1,0.9,0,0}
\definecolor{aswe-proactive}{cmyk}{0.6,0.9,0,0}
\definecolor{aswe-preferences}{cmyk}{0,0.75,1,0}
\definecolor{aswe-data}{cmyk}{0.85,0.1,1,0}

\setcounter{tocdepth}{1}  % Hide subsections in table of contents

\title{Introduction to Apache Cassandra}
\subtitle{}
\date{April 10, 2019}
\author{David Marchi, Daniel Sch√§fer, Erik Zeiske}
% \titlegraphic{\hfill\includegraphics[height=1.5cm]{logo.pdf}}

\begin{document}

\maketitle

\begin{frame}{Agenda}
  \tableofcontents
\end{frame}

\section{Properties (overview)}  % David

\section{Wide Column Store}  % David

\section{Usecases Cassandra is (not) suited for}  % David
\subsection{Pros and cons}
\subsection{Suitable usecases}

\section{How to use CQL}  % Erik
\subsection{Compare to API (key-value)}
\subsection{Compare to SQL}

\section{How to model data (or rather tables)}  % David

\subsection{How secondary indexes work and when to use them}  % Daniel

\section{Local reads and writes}  % Erik
\subsection{Write process}
\subsection{Read process}
\subsection{How data is stored on disk}

\section{How the cluster works}  % Daniel
\subsection{What happens when a new node is added}
\subsection{How the cluster is initially set up}

\section{Distributed writes and reads}  % Daniel
\subsection{How data is replicated}
\subsection{How data is read with consensus}

\section{Set up and must knows}  % Daniel

\begin{frame}[fragile]{Setup - overview}
  \begin{itemize}
    \item Get enough nodes ($\geq3$ with $8+$ cores and 32GB RAM, lots of disk)
    % http://cassandra.apache.org/doc/latest/operating/hardware.html
    \item Set up network (each node with own IP reachable from the others)
    \item Adapt configuration files
    \item Open firewall for necessary ports
    \begin{itemize}
      \item 7000: node $\leftrightarrow$ node (\lstinline{storage_port})
      \item 9042: client $\leftrightarrow$ node (\lstinline{native_transport_port})
    \end{itemize}
    \item Start seed nodes and then other nodes
    \item Use \lstinline{nodetool} or \lstinline{cqlsh} to interact with the cluster
  \end{itemize}
\note[item]{Number for recommended nodes from Apache}
\note[item]{ECC RAM and SSD are recommended}
\note[item]{DataStax recommends keeping data per node near or below 1 TB}
% https://docs.datastax.com/en/dse-planning/doc/planning/planningHardware.html
\note[item]{Cloud is perfectly suited for this}
\note[item]{Two nodes cannot share a broadcast address (e.g. NAT)}
\end{frame}

\begin{frame}[fragile]{How to set up - Initial node}
/etc/cassandra/cassandra.yaml
\begin{semiverbatim}
# Opens socket on this address
listen_address: "192.168.0.2"
# Tells other nodes it's reachable on this address
broadcast_address: "3.14.1.59"

seed_provider:
  - class_name: org.apache.cassandra.locator.SimpleSeedProvider
    parameters:
      - seeds "3.14.1.59"

# Enable client communication
start_native_transport: true
\end{semiverbatim}
\note[item]{Own broadcast address is in seeds \rightarrow Creates own cluster}
\note[item]{For single node cluster use \lstinline{localhost} everywhere}
\end{frame}

\begin{frame}[fragile]{How to set up - Further nodes}
/etc/cassandra/cassandra.yaml
\begin{semiverbatim}
# Opens socket on this address
listen_address: "192.168.1.2"
# Tells other nodes it's reachable on this address
broadcast_address: "6.28.3.18"

seed_provider:
  - class_name: org.apache.cassandra.locator.SimpleSeedProvider
    parameters:
      - seeds "3.14.1.59"

# Enable client communication
start_native_transport: true
\end{semiverbatim}
\note[item]{Seeds is a comma separated "list" of IPs}
\note[item]{Three per datacenter recommended}
\end{frame}

\begin{frame}{More configuration}
  \begin{itemize}
    \item Tune JVM parameters like heap size in \lstinline{cassandra-env.sh}
    \item Increase the number of tokens (virtual nodes) with \lstinline{num_tokens}
    \item Other performance, architecture or security tuning
  \end{itemize}
\end{frame}

\subsection{Things to keep in mind}
% How to set up as an admin / Must knows

\section{Summary and Conclusion}

\end{document}
